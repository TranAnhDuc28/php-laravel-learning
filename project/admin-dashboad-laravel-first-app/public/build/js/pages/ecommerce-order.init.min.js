var T=function(t){var n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=new Date(t),s=a.getHours()+":"+a.getMinutes(),p=s.split(":"),r=p[0],d=p[1],A=r>=12?"PM":"AM";return r=r%12,r=r||12,d=d<10?"0"+d:d,month=""+n[a.getMonth()],day=""+a.getDate(),year=a.getFullYear(),month.length<2&&(month="0"+month),day.length<2&&(day="0"+day),[day+" "+month+","+year+" <small class='text-muted'>"+r+":"+d+" "+A+"</small>"]},F=document.getElementById("idStatus");new Choices(F,{searchEnabled:!1});var D=document.getElementById("idPayment");new Choices(D,{searchEnabled:!1});var L=document.getElementById("checkAll");L&&(L.onclick=function(){for(var e=document.querySelectorAll('.form-check-all input[type="checkbox"]'),t=document.querySelectorAll('.form-check-all input[type="checkbox"]:checked').length,n=0;n<e.length;n++)e[n].checked=this.checked,e[n].checked?e[n].closest("tr").classList.add("table-active"):e[n].closest("tr").classList.remove("table-active");t>0?document.getElementById("remove-actions").style.display="none":document.getElementById("remove-actions").style.display="block"});var h=8,b=!1,O={valueNames:["id","customer_name","product_name","date","amount","payment","status"],page:h,pagination:!0,plugins:[ListPagination({left:2,right:2})]},l=new List("orderList",O).on("updated",function(e){e.matchingItems.length==0?document.getElementsByClassName("noresult")[0].style.display="block":document.getElementsByClassName("noresult")[0].style.display="none";var t=e.i==1,n=e.i>e.matchingItems.length-e.page;document.querySelector(".pagination-prev.disabled")&&document.querySelector(".pagination-prev.disabled").classList.remove("disabled"),document.querySelector(".pagination-next.disabled")&&document.querySelector(".pagination-next.disabled").classList.remove("disabled"),t&&document.querySelector(".pagination-prev").classList.add("disabled"),n&&document.querySelector(".pagination-next").classList.add("disabled"),e.matchingItems.length<=h?document.querySelector(".pagination-wrap").style.display="none":document.querySelector(".pagination-wrap").style.display="flex",e.matchingItems.length==h&&document.querySelector(".pagination.listjs-pagination").firstElementChild.children[0].click(),e.matchingItems.length>0?document.getElementsByClassName("noresult")[0].style.display="none":document.getElementsByClassName("noresult")[0].style.display="block"});const k=new XMLHttpRequest;k.onload=function(){var e=JSON.parse(this.responseText);Array.from(e).forEach(function(t){l.add({id:'<a href="apps-ecommerce-order-details" class="fw-medium link-primary">#VZ'+t.id+"</a>",customer_name:t.customer_name,product_name:t.product_name,date:T(t.date),amount:t.amount,payment:t.payment,status:B(t.status)}),l.sort("id",{order:"desc"}),S()}),l.remove("id",'<a href="apps-ecommerce-order-details" class="fw-medium link-primary">#VZ2101</a>')};k.open("GET","build/json/orders-list.init.json");k.send();isCount=new DOMParser().parseFromString(l.items.slice(-1)[0]._values.id,"text/html");isCount.body.firstElementChild.innerHTML;var E=document.getElementById("orderId"),g=document.getElementById("customername-field"),i=document.getElementById("productname-field"),c=document.getElementById("date-field"),v=document.getElementById("amount-field"),o=document.getElementById("payment-field"),f=document.getElementById("delivered-status");document.getElementById("add-btn");document.getElementById("edit-btn");var w=document.getElementsByClassName("remove-item-btn"),C=document.getElementsByClassName("edit-item-btn");S();var H=document.querySelectorAll('a[data-bs-toggle="tab"]');Array.from(H).forEach(function(e){e.addEventListener("shown.bs.tab",function(t){q(t.target.id)})});function q(e){var t=e;l.filter(function(n){var a=!1;matchData=new DOMParser().parseFromString(n.values().status,"text/html");var s=matchData.body.firstElementChild.innerHTML;return s=="All"||t=="All"?a=!0:a=s==t,a}),l.update()}document.getElementById("showModal").addEventListener("show.bs.modal",function(e){e.relatedTarget.classList.contains("edit-item-btn")?(document.getElementById("exampleModalLabel").innerHTML="Edit Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Update"):e.relatedTarget.classList.contains("add-btn")?(document.getElementById("modal-id").style.display="none",document.getElementById("exampleModalLabel").innerHTML="Add Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Add Order"):(document.getElementById("exampleModalLabel").innerHTML="List Order",document.getElementById("showModal").querySelector(".modal-footer").style.display="none")});_();document.getElementById("showModal").addEventListener("hidden.bs.modal",function(){I()});document.querySelector("#orderList").addEventListener("click",function(){_()});var x=document.getElementById("orderTable");x.getElementsByTagName("tr");x.querySelectorAll(".list tr");var M=13,N=document.querySelectorAll(".tablelist-form");Array.prototype.slice.call(N).forEach(function(e){e.addEventListener("submit",function(t){if(!e.checkValidity())t.preventDefault(),t.stopPropagation();else if(t.preventDefault(),g.value!==""&&i.value!==""&&c.value!==""&&v.value!==""&&o.value!==""&&!b)l.add({id:'<a href="apps-ecommerce-order-details" class="fw-medium link-primary">#VZ'+M+"</a>",customer_name:g.value,product_name:i.value,date:c.value,amount:"$"+v.value,payment:o.value,status:B(f.value)}),l.sort("id",{order:"desc"}),document.getElementById("close-modal").click(),I(),S(),q("All"),M++,Swal.fire({position:"center",icon:"success",title:"Order inserted successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0});else if(g.value!==""&&i.value!==""&&c.value!==""&&v.value!==""&&o.value!==""&&b){var n=l.get({id:E.value});Array.from(n).forEach(function(a){isid=new DOMParser().parseFromString(a._values.id,"text/html");var s=isid.body.firstElementChild.innerHTML;s==itemId&&a.values({id:'<a href="javascript:void(0);" class="fw-medium link-primary">'+E.value+"</a>",customer_name:g.value,product_name:i.value,date:c.value.slice(0,14)+'<small class="text-muted">'+c.value.slice(14,22),amount:v.value,payment:o.value,status:B(f.value)})}),document.getElementById("close-modal").click(),I(),Swal.fire({position:"center",icon:"success",title:"Order updated Successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})}},!1)});var u=new Choices(o),m=new Choices(f),y=new Choices(i);function B(e){switch(e){case"Delivered":return'<span class="badge bg-success-subtle text-success text-uppercase">'+e+"</span>";case"Cancelled":return'<span class="badge bg-danger-subtle text-danger text-uppercase">'+e+"</span>";case"Inprogress":return'<span class="badge bg-secondary-subtle text-secondary text-uppercase">'+e+"</span>";case"Pickups":return'<span class="badge bg-info-subtle text-info text-uppercase">'+e+"</span>";case"Returns":return'<span class="badge bg-primary-subtle text-primary text-uppercase">'+e+"</span>";case"Pending":return'<span class="badge bg-warning-subtle text-warning text-uppercase">'+e+"</span>"}}function _(){Array.from(document.getElementsByName("checkAll")).forEach(function(e){e.addEventListener("change",function(t){e.checked==!0?t.target.closest("tr").classList.add("table-active"):t.target.closest("tr").classList.remove("table-active");var n=document.querySelectorAll('[name="checkAll"]:checked').length;t.target.closest("tr").classList.contains("table-active"),n>0?document.getElementById("remove-actions").style.display="block":document.getElementById("remove-actions").style.display="none"})})}function S(){w&&Array.from(w).forEach(function(e){e.addEventListener("click",function(t){t.target.closest("tr").children[1].innerText,itemId=t.target.closest("tr").children[1].innerText;var n=l.get({id:itemId});Array.from(n).forEach(function(a){deleteid=new DOMParser().parseFromString(a._values.id,"text/html");var s=deleteid.body.firstElementChild,p=deleteid.body.firstElementChild.innerHTML;p==itemId&&document.getElementById("delete-record").addEventListener("click",function(){l.remove("id",s.outerHTML),document.getElementById("deleteRecord-close").click()})})})}),C&&Array.from(C).forEach(function(e){e.addEventListener("click",function(t){t.target.closest("tr").children[1].innerText,itemId=t.target.closest("tr").children[1].innerText;var n=l.get({id:itemId});Array.from(n).forEach(function(a){isid=new DOMParser().parseFromString(a._values.id,"text/html");var s=isid.body.firstElementChild.innerHTML;if(s==itemId){b=!0,E.value=s,g.value=a._values.customer_name,i.value=a._values.product_name,c.value=a._values.date,v.value=a._values.amount,u&&u.destroy(),u=new Choices(o,{searchEnabled:!1});var p=a._values.payment;u.setChoiceByValue(p),y&&y.destroy(),y=new Choices(i,{searchEnabled:!1});var r=a._values.product_name;y.setChoiceByValue(r),m&&m.destroy(),m=new Choices(f,{searchEnabled:!1}),val=new DOMParser().parseFromString(a._values.status,"text/html");var d=val.body.firstElementChild.innerHTML;m.setChoiceByValue(d),flatpickr("#date-field",{enableTime:!0,dateFormat:"d M, Y, h:i K",defaultDate:a._values.date})}})})})}function I(){g.value="",i.value="",c.value="",v.value="",o.value="",u&&u.destroy(),u=new Choices(o),y&&y.destroy(),y=new Choices(i),m&&m.destroy(),m=new Choices(f)}document.querySelector(".pagination-next").addEventListener("click",function(){document.querySelector(".pagination.listjs-pagination")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").nextElementSibling.children[0].click()});document.querySelector(".pagination-prev").addEventListener("click",function(){document.querySelector(".pagination.listjs-pagination")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").previousSibling.children[0].click()});
